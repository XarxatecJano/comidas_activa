
> appcomidassemana@1.0.0 test
> jest

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: üë• sync secrets across teammates & machines: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: ‚öôÔ∏è  override existing env vars with { override: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: ‚öôÔ∏è  enable debug logging with { debug: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: üîë add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: üì° add observability to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: üîÑ add secrets lifecycle management: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: üîë add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

PASS tests/services/DatabaseService.test.ts (30.896 s)
  DatabaseService
    User Methods
      ‚úì createUser should create a new user (757 ms)
      ‚úì getUserById should return user by id (207 ms)
      ‚úì getUserByEmail should return user by email (60 ms)
      ‚úì updateUser should update user data (177 ms)
      ‚úì getUserById should return null for non-existent user (1 ms)
    MenuPlan Methods
      ‚úì createMenuPlan should create a new menu plan (30 ms)
      ‚úì getMenuPlanById should return menu plan by id (174 ms)
      ‚úì confirmMenuPlan should change status to confirmed (81 ms)
      ‚úì getMenuPlanById should return null for non-existent plan (4 ms)
    Meal Methods
      ‚úì createMeal should create a new meal (14 ms)
      ‚úì getMealById should return meal by id (117 ms)
      ‚úì getMealsByMenuPlanId should return all meals for a plan (32 ms)
      ‚úì updateMeal should update meal data (85 ms)
      ‚úì getMealById should return null for non-existent meal (17 ms)
    Diner Methods
      ‚úì createDiner should create a new diner (79 ms)
      ‚úì getDinersByMealId should return all diners for a meal (3 ms)
      ‚úì deleteDinersByMealId should delete all diners for a meal (21 ms)
    Dish Methods
      ‚úì createDish should create a new dish (19 ms)
      ‚úì getDishesByMealId should return all dishes for a meal (14 ms)
      ‚úì deleteDishesByMealId should delete all dishes for a meal (9 ms)
    ShoppingList Methods
      ‚úì createShoppingList should create a new shopping list (12 ms)
      ‚úì getShoppingListByMenuPlanId should return shopping list for a plan (4 ms)
      ‚úì getShoppingListById should return shopping list by id (4 ms)
      ‚úì getShoppingListById should return null for non-existent list (3 ms)
    Transaction Methods
      ‚úì should handle transactions correctly (32 ms)
      ‚úì should rollback transaction on error (5 ms)
    Delete Methods
      ‚úì deleteMeal should delete a meal (24 ms)
      ‚úì deleteUser should delete a user and cascade (22 ms)
      ‚úì deleteUser should return false for non-existent user (3 ms)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

  console.error
    Update user error: Error: Validation failed: Invalid email format
        at UserService.updateUser (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/services/UserService.ts:49:13)
        at /Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/routes/user.routes.ts:81:43
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/compose.js:44:17)
        at authMiddleware (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/middleware/auth.ts:31:5)
        at dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/compose.js:44:17)
        at /Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:223:25
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/routes/user.routes.test.ts:233:19)

      85 |     return c.json({ user: userWithoutPassword }, 200);
      86 |   } catch (error: any) {
    > 87 |     console.error('Update user error:', error);
         |             ^
      88 |
      89 |     if (error.message.includes('not found')) {
      90 |       return c.json(

      at src/routes/user.routes.ts:87:13
      at dispatch (node_modules/hono/dist/cjs/compose.js:44:17)
      at authMiddleware (src/middleware/auth.ts:31:5)
      at dispatch (node_modules/hono/dist/cjs/compose.js:44:17)
      at node_modules/hono/dist/cjs/hono-base.js:223:25
      at Object.<anonymous> (tests/routes/user.routes.test.ts:233:19)

  console.error
    Update user error: Error: Email already exists
        at UserService.updateUser (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/services/UserService.ts:62:15)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at /Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/routes/user.routes.ts:81:25
        at dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/compose.js:44:17)
        at authMiddleware (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/middleware/auth.ts:31:5)
        at dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/compose.js:44:17)
        at /Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:223:25
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/routes/user.routes.test.ts:250:19)

      85 |     return c.json({ user: userWithoutPassword }, 200);
      86 |   } catch (error: any) {
    > 87 |     console.error('Update user error:', error);
         |             ^
      88 |
      89 |     if (error.message.includes('not found')) {
      90 |       return c.json(

      at src/routes/user.routes.ts:87:13
      at dispatch (node_modules/hono/dist/cjs/compose.js:44:17)
      at authMiddleware (src/middleware/auth.ts:31:5)
      at dispatch (node_modules/hono/dist/cjs/compose.js:44:17)
      at node_modules/hono/dist/cjs/hono-base.js:223:25
      at Object.<anonymous> (tests/routes/user.routes.test.ts:250:19)

PASS tests/routes/user.routes.test.ts (31.995 s)
  User Routes
    GET /api/users/:id
      ‚úì should get user data successfully (246 ms)
      ‚úì should return 401 without token (5 ms)
      ‚úì should return 403 when accessing other user data (3 ms)
      ‚úì should return 404 for non-existent user (29 ms)
    PUT /api/users/:id
      ‚úì should update user data successfully (191 ms)
      ‚úì should update email successfully (173 ms)
      ‚úì should return 401 without token (9 ms)
      ‚úì should return 403 when updating other user (8 ms)
      ‚úì should return 400 for no fields provided (5 ms)
      ‚úì should return 400 for invalid email (294 ms)
      ‚úì should return 400 for duplicate email (13 ms)
    PUT /api/users/:id/preferences
      ‚úì should update preferences successfully (14 ms)
      ‚úì should allow empty preferences (59 ms)
      ‚úì should return 401 without token (1 ms)
      ‚úì should return 403 when updating other user preferences (2 ms)
      ‚úì should return 400 for missing preferences field (3 ms)
    DELETE /api/users/:id
      ‚úì should delete user successfully (171 ms)
      ‚úì should return 401 without token (1 ms)
      ‚úì should return 403 when deleting other user (2 ms)

  console.error
    Create menu plan error: Error: End date must be after start date, Minimum 1 day required per menu plan
        at MenuPlanService.createMenuPlan (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/services/MenuPlanService.ts:36:13)
        at /Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/routes/menuPlan.routes.ts:35:44
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/compose.js:44:17)
        at authMiddleware (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/middleware/auth.ts:31:5)
        at dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/compose.js:44:17)
        at /Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:223:25
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/routes/menuPlan.routes.test.ts:177:19)

      44 |     return c.json({ menuPlan }, 201);
      45 |   } catch (error: any) {
    > 46 |     console.error('Create menu plan error:', error);
         |             ^
      47 |
      48 |     if (error.message.includes('User not found')) {
      49 |       return c.json(

      at src/routes/menuPlan.routes.ts:46:13
      at dispatch (node_modules/hono/dist/cjs/compose.js:44:17)
      at authMiddleware (src/middleware/auth.ts:31:5)
      at dispatch (node_modules/hono/dist/cjs/compose.js:44:17)
      at node_modules/hono/dist/cjs/hono-base.js:223:25
      at Object.<anonymous> (tests/routes/menuPlan.routes.test.ts:177:19)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: üîÑ add secrets lifecycle management: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: üîÑ add secrets lifecycle management: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

PASS tests/services/UserDinerPreferencesService.test.ts (33.45 s)
  UserDinerPreferencesService
    getPreferences
      ‚úì should return empty array when no preferences are set (1222 ms)
      ‚úì should return family member IDs for lunch preferences (348 ms)
      ‚úì should return family member IDs for dinner preferences (24 ms)
      ‚úì should return different preferences for lunch and dinner (184 ms)
      ‚úì should throw error for invalid meal type (90 ms)
      ‚úì should throw error for missing userId (48 ms)
    setPreferences
      ‚úì should set preferences for lunch (51 ms)
      ‚úì should set preferences for dinner (439 ms)
      ‚úì should update existing preferences (356 ms)
      ‚úì should handle empty family member IDs array (231 ms)
      ‚úì should handle multiple family member IDs (78 ms)
      ‚úì should throw error for invalid meal type (70 ms)
      ‚úì should throw error for invalid family member ID format (54 ms)
      ‚úì should throw error for non-array family member IDs (62 ms)
    clearPreferences
      ‚úì should clear lunch preferences (317 ms)
      ‚úì should clear dinner preferences (348 ms)
      ‚úì should only clear preferences for specified meal type (119 ms)
      ‚úì should not throw error when clearing non-existent preferences (59 ms)
      ‚úì should throw error for invalid meal type (58 ms)
    Property Tests
      ‚úì should persist bulk selections correctly (Property 6) (352 ms)
      ‚úì should isolate preferences between different users (Property 7) (65 ms)

PASS tests/services/DatabaseService.diner-preferences.test.ts (33.696 s)
  DatabaseService - Diner Preferences Methods
    getUserDinerPreferences
      ‚úì should return empty array when no preferences are set (1620 ms)
      ‚úì should return preferences for lunch (170 ms)
      ‚úì should return multiple preferences (112 ms)
      ‚úì should return different preferences for lunch and dinner (101 ms)
    setUserDinerPreferences
      ‚úì should set preferences for a meal type (277 ms)
      ‚úì should replace existing preferences (677 ms)
      ‚úì should handle empty array (clear preferences) (176 ms)
      ‚úì should handle multiple family members (119 ms)
    deleteUserDinerPreferences
      ‚úì should delete preferences for a meal type (356 ms)
      ‚úì should only delete preferences for specified meal type (401 ms)
      ‚úì should not throw error when deleting non-existent preferences (64 ms)
    setMealCustomDinersFlag
      ‚úì should set has_custom_diners to true (125 ms)
      ‚úì should set has_custom_diners to false (359 ms)
    getMealWithResolvedDiners
      ‚úì should return meal with bulk selection diners when has_custom_diners is false (61 ms)
      ‚úì should return empty diners array when no bulk preferences are set (70 ms)
      ‚úì should return null for non-existent meal (59 ms)
    Property Test: Diner Resolution Correctness (Property 8)
      ‚úì should correctly resolve diners based on has_custom_diners flag (34 ms)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: üîë add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: ‚öôÔ∏è  specify custom .env file path with { path: '/custom/path/.env' }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

PASS tests/routes/menuPlan.routes.test.ts (35.09 s)
  MenuPlan Routes
    POST /api/menu-plans
      ‚úì should create menu plan successfully (322 ms)
      ‚úì should return 401 without token (3 ms)
      ‚úì should return 400 for missing required fields (4 ms)
      ‚úì should return 400 for invalid date range (128 ms)
    GET /api/menu-plans/:id
      ‚úì should get menu plan successfully (470 ms)
      ‚úì should return 401 without token (273 ms)
      ‚úì should return 403 when accessing other user plan (134 ms)
      ‚úì should return 404 for non-existent plan (301 ms)
    PUT /api/menu-plans/:id/meals/:mealId
      ‚úì should update meal successfully (195 ms)
      ‚úì should return 401 without token (82 ms)
      ‚úì should return 403 when updating other user meal (49 ms)
    POST /api/menu-plans/:id/confirm
      ‚úì should confirm menu plan successfully (215 ms)
      ‚úì should return 401 without token (310 ms)
      ‚úì should return 403 when confirming other user plan (802 ms)
      ‚úì should return 404 for non-existent plan (213 ms)

  console.error
    Register error: Error: Validation failed: Invalid email format
        at UserService.createUser (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/services/UserService.ts:13:13)
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/routes/auth.routes.ts:31:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/routes/auth.routes.test.ts:155:19)

      48 |     );
      49 |   } catch (error: any) {
    > 50 |     console.error('Register error:', error);
         |             ^
      51 |     
      52 |     if (error.message.includes('Email already exists')) {
      53 |       return c.json(

      at Array.<anonymous> (src/routes/auth.routes.ts:50:13)
      at Object.<anonymous> (tests/routes/auth.routes.test.ts:155:19)

  console.error
    Register error: Error: Validation failed: Password must be at least 8 characters long
        at UserService.createUser (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/services/UserService.ts:13:13)
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/routes/auth.routes.ts:31:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/routes/auth.routes.test.ts:175:19)

      48 |     );
      49 |   } catch (error: any) {
    > 50 |     console.error('Register error:', error);
         |             ^
      51 |     
      52 |     if (error.message.includes('Email already exists')) {
      53 |       return c.json(

      at Array.<anonymous> (src/routes/auth.routes.ts:50:13)
      at Object.<anonymous> (tests/routes/auth.routes.test.ts:175:19)

  console.error
    Register error: Error: Email already exists
        at UserService.createUser (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/services/UserService.ts:19:13)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/routes/auth.routes.ts:31:22)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/routes/auth.routes.test.ts:199:19)

      48 |     );
      49 |   } catch (error: any) {
    > 50 |     console.error('Register error:', error);
         |             ^
      51 |     
      52 |     if (error.message.includes('Email already exists')) {
      53 |       return c.json(

      at Array.<anonymous> (src/routes/auth.routes.ts:50:13)
      at Object.<anonymous> (tests/routes/auth.routes.test.ts:199:19)

PASS tests/routes/shoppingList.routes.test.ts (36.118 s)
  ShoppingList Routes
    POST /api/shopping-lists
      ‚úì should create shopping list successfully (801 ms)
      ‚úì should return 401 without token (484 ms)
      ‚úì should return 400 for missing menuPlanId (474 ms)
      ‚úì should return 404 for non-existent menu plan (176 ms)
      ‚úì should return 400 for unconfirmed menu plan (247 ms)
    GET /api/shopping-lists/:id
      ‚úì should get shopping list successfully (1023 ms)
      ‚úì should return 401 without token (315 ms)
      ‚úì should return 403 when accessing other user shopping list (180 ms)
      ‚úì should return 404 for non-existent shopping list (523 ms)

PASS tests/services/UserService.test.ts
  UserService
    createUser
      ‚úì should create a new user with hashed password (869 ms)
      ‚úì should throw error for invalid email (47 ms)
      ‚úì should throw error for short password (1 ms)
      ‚úì should throw error for duplicate email (4 ms)
      ‚úì should throw error for empty name
    getUserById
      ‚úì should return user by id (3 ms)
      ‚úì should return null for non-existent user (5 ms)
    getUserByEmail
      ‚úì should return user by email (8 ms)
      ‚úì should throw error for invalid email format
      ‚úì should return null for non-existent email (3 ms)
    updateUser
      ‚úì should update user data (22 ms)
      ‚úì should throw error for non-existent user (135 ms)
      ‚úì should throw error for invalid email format (1 ms)
      ‚úì should throw error for duplicate email (42 ms)
    updatePreferences
      ‚úì should update user preferences (2 ms)
      ‚úì should throw error for non-existent user (2 ms)
    verifyPassword
      ‚úì should verify correct password (204 ms)
      ‚úì should reject incorrect password (279 ms)
      ‚úì should return false for non-existent user (35 ms)
    verifyPasswordByEmail
      ‚úì should verify correct password by email (125 ms)
      ‚úì should reject incorrect password by email (116 ms)
      ‚úì should return false for non-existent email (19 ms)
    deleteUser
      ‚úì should throw error for non-existent user (28 ms)
      ‚úì should delete user successfully (88 ms)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)

PASS tests/services/MenuPlanService.test.ts (36.613 s)
  MenuPlanService
    Property Tests
      Property 1: Bulk selection application
        ‚úì should apply bulk selection to all meals when creating menu plan (1191 ms)
        ‚úì should use default diners when no bulk preferences are set (447 ms)
      Property 2: Override isolation
        ‚úì should not update meals with custom diners when applying bulk selection (1134 ms)
      Property 3: Override flag persistence
        ‚úì should set has_custom_diners flag when updating meal with custom diners (539 ms)
        ‚úì should maintain has_custom_diners flag when regenerating dishes without changing diners (403 ms)
      Property 4: Override reversion
        ‚úì should revert meal to bulk selection when clearing custom diners flag (1371 ms)
    Unit Tests
      createMenuPlan
        ‚úì should create menu plan with bulk selection (508 ms)
        ‚úì should throw error for invalid date range (214 ms)
        ‚úì should throw error for non-existent user (37 ms)
      updateMeal
        ‚úì should update meal with custom diners (176 ms)
        ‚úì should throw error for non-existent meal (33 ms)
      applyBulkDiners
        ‚úì should apply bulk selection to all meals without custom diners (194 ms)
        ‚úì should throw error for non-existent menu plan (24 ms)

  console.error
    Login error: Error: Invalid credentials
        at AuthService.login (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/services/AuthService.ts:28:13)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/routes/auth.routes.ts:88:20)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/routes/auth.routes.test.ts:289:19)

      90 |     return c.json(result, 200);
      91 |   } catch (error: any) {
    > 92 |     console.error('Login error:', error);
         |             ^
      93 |
      94 |     if (error.message.includes('Invalid credentials')) {
      95 |       return c.json(

      at Array.<anonymous> (src/routes/auth.routes.ts:92:13)
      at Object.<anonymous> (tests/routes/auth.routes.test.ts:289:19)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: ‚úÖ audit secrets and track compliance: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (5) from .env -- tip: üîê prevent committing .env to code: https://dotenvx.com/precommit

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.error
    Login error: Error: Invalid credentials
        at AuthService.login (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/services/AuthService.ts:34:13)
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/src/routes/auth.routes.ts:88:20)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/routes/auth.routes.test.ts:308:19)

      90 |     return c.json(result, 200);
      91 |   } catch (error: any) {
    > 92 |     console.error('Login error:', error);
         |             ^
      93 |
      94 |     if (error.message.includes('Invalid credentials')) {
      95 |       return c.json(

      at Array.<anonymous> (src/routes/auth.routes.ts:92:13)
      at Object.<anonymous> (tests/routes/auth.routes.test.ts:308:19)

PASS tests/routes/auth.routes.test.ts (5.947 s)
  Auth Routes
    POST /api/auth/register
      ‚úì should register a new user successfully (971 ms)
      ‚úì should register user with default values (244 ms)
      ‚úì should return 400 for missing email (10 ms)
      ‚úì should return 400 for missing password (7 ms)
      ‚úì should return 400 for missing name (9 ms)
      ‚úì should return 400 for invalid email format (99 ms)
      ‚úì should return 400 for short password (9 ms)
      ‚úì should return 400 for duplicate email (455 ms)
    POST /api/auth/login
      ‚úì should login successfully with valid credentials (391 ms)
      ‚úì should return 400 for missing email (171 ms)
      ‚úì should return 400 for missing password (120 ms)
      ‚úì should return 401 for invalid email (126 ms)
      ‚úì should return 401 for invalid password (384 ms)
    POST /api/auth/logout
      ‚úì should logout successfully (3 ms)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:33:29)

  console.error
    Error Name: ValidationError

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:33:29)

  console.error
    Error Message: Invalid input data

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:33:29)

  console.error
    Error Stack: ValidationError: Invalid input data
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:29:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:33:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:33:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:33:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:33:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:33:29)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:48:29)

  console.error
    Error Name: AuthenticationError

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:48:29)

  console.error
    Error Message: Invalid token

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:48:29)

  console.error
    Error Stack: AuthenticationError: Invalid token
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:44:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:48:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:48:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:48:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:48:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:48:29)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:62:29)

  console.error
    Error Name: AuthorizationError

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:62:29)

  console.error
    Error Message: Access denied

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:62:29)

  console.error
    Error Stack: AuthorizationError: Access denied
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:58:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:62:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:62:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:62:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:62:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:62:29)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:76:29)

  console.error
    Error Name: NotFoundError

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:76:29)

  console.error
    Error Message: Resource not found

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:76:29)

  console.error
    Error Stack: NotFoundError: Resource not found
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:72:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:76:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:76:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:76:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:76:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:76:29)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:90:29)

  console.error
    Error Name: AIServiceError

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:90:29)

  console.error
    Error Message: AI service failed

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:90:29)

  console.error
    Error Stack: AIServiceError: AI service failed
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:86:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:90:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:90:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:90:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:90:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:90:29)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:104:29)

  console.error
    Error Name: DatabaseError

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:104:29)

  console.error
    Error Message: Database connection failed

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:104:29)

PASS tests/services/AuthService.test.ts
  AuthService
    login
      ‚úì should login successfully with valid credentials (228 ms)
      ‚úì should fail login with invalid email (427 ms)
      ‚úì should fail login with invalid password (104 ms)
    generateToken
      ‚úì should generate a valid JWT token (3 ms)
    verifyToken
      ‚úì should verify a valid token (4 ms)
      ‚úì should fail to verify an invalid token (28 ms)
      ‚úì should fail to verify a malformed token (1 ms)
    getUserFromToken
      ‚úì should get user from valid token (20 ms)
      ‚úì should return null for invalid token
      ‚úì should return null for token with non-existent user (56 ms)
    logout
      ‚úì should return logout message (1 ms)
    refreshToken
      ‚úì should refresh a valid token (1007 ms)
      ‚úì should fail to refresh invalid token (1 ms)
      ‚úì should fail to refresh token for deleted user (257 ms)
    Integration: Full auth flow
      ‚úì should complete full authentication flow (152 ms)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)

  console.error
    Error Stack: DatabaseError: Database connection failed
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:100:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:104:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:104:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:104:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:104:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:104:29)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:120:29)

  console.error
    Error Name: Error

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:120:29)

  console.error
    Error Message: Validation failed: email is required

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:120:29)

  console.error
    Error Stack: Error: Validation failed: email is required
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:116:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:120:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:120:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:120:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:120:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:120:29)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:133:29)

  console.error
    Error Name: Error

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:133:29)

  console.error
    Error Message: Invalid credentials provided

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:133:29)

  console.error
    Error Stack: Error: Invalid credentials provided
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:129:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:133:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:133:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:133:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:133:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:133:29)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:146:29)

  console.error
    Error Name: Error

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:146:29)

  console.error
    Error Message: Access denied to this resource

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:146:29)

  console.error
    Error Stack: Error: Access denied to this resource
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:142:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:146:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:146:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:146:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:146:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:146:29)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:159:29)

  console.error
    Error Name: Error

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:159:29)

  console.error
    Error Message: User not found

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:159:29)

  console.error
    Error Stack: Error: User not found
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:155:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:159:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:159:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:159:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:159:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:159:29)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:174:29)

  console.error
    Error Name: Error

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:174:29)

  console.error
    Error Message: Something went wrong

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:174:29)

  console.error
    Error Stack: Error: Something went wrong
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:170:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:174:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:174:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:174:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:174:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:174:29)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:188:29)

  console.error
    Error Name: Error

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:188:29)

  console.error
    Error Message: Test error

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:188:29)

  console.error
    Error Stack: Error: Test error
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:184:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:188:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:188:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:188:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:188:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:188:29)

  console.error
    === Error Handler ===

      60 | export function errorHandler(err: Error, c: Context) {
      61 |   // Log del error
    > 62 |   console.error('=== Error Handler ===');
         |           ^
      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);

      at Hono.errorHandler (src/middleware/errorHandler.ts:62:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:229:29)

  console.error
    Error Name: ValidationError

      61 |   // Log del error
      62 |   console.error('=== Error Handler ===');
    > 63 |   console.error('Error Name:', err.name);
         |           ^
      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);

      at Hono.errorHandler (src/middleware/errorHandler.ts:63:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:229:29)

  console.error
    Error Message: Test error

      62 |   console.error('=== Error Handler ===');
      63 |   console.error('Error Name:', err.name);
    > 64 |   console.error('Error Message:', err.message);
         |           ^
      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);

      at Hono.errorHandler (src/middleware/errorHandler.ts:64:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:229:29)

  console.error
    Error Stack: ValidationError: Test error
        at Array.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:225:15)
        at Hono.#dispatch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:210:38)
        at Hono.fetch (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/hono/dist/cjs/hono-base.js:236:26)
        at Object.<anonymous> (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/tests/middleware/errorHandler.test.ts:229:29)
        at Promise.then.completed (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/utils.js:231:10)
        at _callCircusTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:252:3)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:126:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at _runTestsForDescribeBlock (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:121:9)
        at run (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/run.js:71:3)
        at runAndTransformResultsToJestFormat (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
        at jestAdapter (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
        at runTestInternal (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:367:16)
        at runTest (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/runTest.js:444:34)
        at Object.worker (/Users/janosoler/Desktop/XarxaTecActiva/Activa2025/appComidasSemana/node_modules/jest-runner/build/testWorker.js:106:12)

      63 |   console.error('Error Name:', err.name);
      64 |   console.error('Error Message:', err.message);
    > 65 |   console.error('Error Stack:', err.stack);
         |           ^
      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');

      at Hono.errorHandler (src/middleware/errorHandler.ts:65:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:229:29)

  console.error
    Request Path: /test

      64 |   console.error('Error Message:', err.message);
      65 |   console.error('Error Stack:', err.stack);
    > 66 |   console.error('Request Path:', c.req.path);
         |           ^
      67 |   console.error('Request Method:', c.req.method);
      68 |   console.error('=====================');
      69 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:66:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:229:29)

  console.error
    Request Method: GET

      65 |   console.error('Error Stack:', err.stack);
      66 |   console.error('Request Path:', c.req.path);
    > 67 |   console.error('Request Method:', c.req.method);
         |           ^
      68 |   console.error('=====================');
      69 |
      70 |   const timestamp = new Date().toISOString();

      at Hono.errorHandler (src/middleware/errorHandler.ts:67:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:229:29)

  console.error
    =====================

      66 |   console.error('Request Path:', c.req.path);
      67 |   console.error('Request Method:', c.req.method);
    > 68 |   console.error('=====================');
         |           ^
      69 |
      70 |   const timestamp = new Date().toISOString();
      71 |

      at Hono.errorHandler (src/middleware/errorHandler.ts:68:11)
      at Hono.#handleError (node_modules/hono/dist/cjs/hono-base.js:190:19)
      at Hono.#dispatch (node_modules/hono/dist/cjs/hono-base.js:214:33)
      at Hono.fetch (node_modules/hono/dist/cjs/hono-base.js:236:26)
      at Object.<anonymous> (tests/middleware/errorHandler.test.ts:229:29)

PASS tests/middleware/errorHandler.test.ts
  Error Handler Middleware
    Custom Error Classes
      ‚úì should handle ValidationError (207 ms)
      ‚úì should handle AuthenticationError (47 ms)
      ‚úì should handle AuthorizationError (55 ms)
      ‚úì should handle NotFoundError (43 ms)
      ‚úì should handle AIServiceError (46 ms)
      ‚úì should handle DatabaseError (225 ms)
    Error Detection by Message
      ‚úì should detect validation errors by message (17 ms)
      ‚úì should detect authentication errors by message (36 ms)
      ‚úì should detect authorization errors by message (37 ms)
      ‚úì should detect not found errors by message (262 ms)
    Generic Errors
      ‚úì should handle generic errors as internal server error (37 ms)
      ‚úì should include timestamp in all error responses (29 ms)
    Not Found Handler
      ‚úì should handle 404 for non-existent routes (6 ms)
      ‚úì should include request method in 404 message (3 ms)
    Error Response Format
      ‚úì should have consistent error response structure (26 ms)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)

FAIL tests/services/AIService.test.ts
  ‚óè Test suite failed to run

    [96mtests/services/AIService.test.ts[0m:[93m361[0m:[93m9[0m - [91merror[0m[90m TS2741: [0mProperty 'hasCustomDiners' is missing in type '{ id: string; menuPlanId: string; dayOfWeek: string; mealType: "lunch"; diners: never[]; dishes: { id: string; mealId: string; name: string; description: string; ingredients: string[]; course: "main"; }[]; createdAt: Date; updatedAt: Date; }' but required in type 'Meal'.

    [7m361[0m         {
    [7m   [0m [91m        ~[0m
    [7m362[0m           id: '1',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m378[0m           updatedAt: new Date(),
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m379[0m         },
    [7m   [0m [91m~~~~~~~~~[0m

      [96msrc/models/Meal.ts[0m:[93m10[0m:[93m3[0m
        [7m10[0m   hasCustomDiners: boolean;
        [7m  [0m [96m  ~~~~~~~~~~~~~~~[0m
        'hasCustomDiners' is declared here.
    [96mtests/services/AIService.test.ts[0m:[93m380[0m:[93m9[0m - [91merror[0m[90m TS2741: [0mProperty 'hasCustomDiners' is missing in type '{ id: string; menuPlanId: string; dayOfWeek: string; mealType: "dinner"; diners: never[]; dishes: { id: string; mealId: string; name: string; description: string; ingredients: string[]; course: "main"; }[]; createdAt: Date; updatedAt: Date; }' but required in type 'Meal'.

    [7m380[0m         {
    [7m   [0m [91m        ~[0m
    [7m381[0m           id: '2',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m397[0m           updatedAt: new Date(),
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m398[0m         },
    [7m   [0m [91m~~~~~~~~~[0m

      [96msrc/models/Meal.ts[0m:[93m10[0m:[93m3[0m
        [7m10[0m   hasCustomDiners: boolean;
        [7m  [0m [96m  ~~~~~~~~~~~~~~~[0m
        'hasCustomDiners' is declared here.
    [96mtests/services/AIService.test.ts[0m:[93m438[0m:[93m9[0m - [91merror[0m[90m TS2741: [0mProperty 'hasCustomDiners' is missing in type '{ id: string; menuPlanId: string; dayOfWeek: string; mealType: "lunch"; diners: never[]; dishes: never[]; createdAt: Date; updatedAt: Date; }' but required in type 'Meal'.

    [7m438[0m         {
    [7m   [0m [91m        ~[0m
    [7m439[0m           id: '1',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m446[0m           updatedAt: new Date(),
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m447[0m         },
    [7m   [0m [91m~~~~~~~~~[0m

      [96msrc/models/Meal.ts[0m:[93m10[0m:[93m3[0m
        [7m10[0m   hasCustomDiners: boolean;
        [7m  [0m [96m  ~~~~~~~~~~~~~~~[0m
        'hasCustomDiners' is declared here.
    [96mtests/services/AIService.test.ts[0m:[93m461[0m:[93m9[0m - [91merror[0m[90m TS2741: [0mProperty 'hasCustomDiners' is missing in type '{ id: string; menuPlanId: string; dayOfWeek: string; mealType: "lunch"; diners: never[]; dishes: never[]; createdAt: Date; updatedAt: Date; }' but required in type 'Meal'.

    [7m461[0m         {
    [7m   [0m [91m        ~[0m
    [7m462[0m           id: '1',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m469[0m           updatedAt: new Date(),
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m470[0m         },
    [7m   [0m [91m~~~~~~~~~[0m

      [96msrc/models/Meal.ts[0m:[93m10[0m:[93m3[0m
        [7m10[0m   hasCustomDiners: boolean;
        [7m  [0m [96m  ~~~~~~~~~~~~~~~[0m
        'hasCustomDiners' is declared here.
    [96mtests/services/AIService.test.ts[0m:[93m492[0m:[93m9[0m - [91merror[0m[90m TS2741: [0mProperty 'hasCustomDiners' is missing in type '{ id: string; menuPlanId: string; dayOfWeek: string; mealType: "lunch"; diners: never[]; dishes: never[]; createdAt: Date; updatedAt: Date; }' but required in type 'Meal'.

    [7m492[0m         {
    [7m   [0m [91m        ~[0m
    [7m493[0m           id: '1',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m500[0m           updatedAt: new Date(),
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m501[0m         },
    [7m   [0m [91m~~~~~~~~~[0m

      [96msrc/models/Meal.ts[0m:[93m10[0m:[93m3[0m
        [7m10[0m   hasCustomDiners: boolean;
        [7m  [0m [96m  ~~~~~~~~~~~~~~~[0m
        'hasCustomDiners' is declared here.
    [96mtests/services/AIService.test.ts[0m:[93m531[0m:[93m9[0m - [91merror[0m[90m TS2741: [0mProperty 'hasCustomDiners' is missing in type '{ id: string; menuPlanId: string; dayOfWeek: string; mealType: "lunch"; diners: never[]; dishes: { id: string; mealId: string; name: string; description: string; ingredients: string[]; course: "main"; }[]; createdAt: Date; updatedAt: Date; }' but required in type 'Meal'.

    [7m531[0m         {
    [7m   [0m [91m        ~[0m
    [7m532[0m           id: '1',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m548[0m           updatedAt: new Date(),
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m549[0m         },
    [7m   [0m [91m~~~~~~~~~[0m

      [96msrc/models/Meal.ts[0m:[93m10[0m:[93m3[0m
        [7m10[0m   hasCustomDiners: boolean;
        [7m  [0m [96m  ~~~~~~~~~~~~~~~[0m
        'hasCustomDiners' is declared here.


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)

  console.log
    ‚úì New client connected to PostgreSQL database

      at BoundPool.<anonymous> (src/config/database.ts:17:11)

PASS tests/shopping-list-calculation.test.ts (11.068 s)
  Shopping List Calculation with Bulk Diners
    ‚úì should correctly resolve diners for shopping list generation (6680 ms)
    ‚úì should reflect updated preferences in shopping list (dynamic resolution) (2656 ms)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)


  ‚óè  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Client removed from pool".

      25 | // Evento de eliminaci√≥n de cliente
      26 | pool.on('remove', (client) => {
    > 27 |   console.log('Client removed from pool');
         |           ^
      28 | });
      29 |
      30 | // Funci√≥n para verificar la conexi√≥n

      at console.log (node_modules/@jest/console/build/CustomConsole.js:141:10)
      at BoundPool.<anonymous> (src/config/database.ts:27:11)
      at Connection.<anonymous> (node_modules/pg-pool/index.js:174:15)
      at Socket.<anonymous> (node_modules/pg/lib/connection.js:62:12)

A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.
Test Suites: 1 failed, 12 passed, 13 total
Tests:       193 passed, 193 total
Snapshots:   0 total
Time:        50.959 s
Ran all test suites.
